<!DOCTYPE html>
<html lang="ar" dir="rtl" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>whisper.com.ly â€“ Ø£Ø¯Ø§Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø§Ù‚Ø© | Fluency Aid Tool</title>
    <meta name="description" content="ØªØ·Ø¨ÙŠÙ‚ whisper.com.ly ÙŠØ³Ø§Ø¹Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„ ÙˆØ§Ù„Ù…ØªÙ„Ø¹Ø«Ù…ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ø¯Ø« Ø¨Ù‡Ø¯ÙˆØ¡ ÙˆØ«Ù‚Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ© DAF ÙˆØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©. Ù†Ø³Ø®Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ù…ØµØ¯Ø±. Whisper helps children and stutterers speak with confidence using DAF technology.">
    <meta name="keywords" content="Ø§Ù„ØªÙ„Ø¹Ø«Ù…, Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒÙ„Ø§Ù…, Ø·Ù„Ø§Ù‚Ø©, Ø§Ù„Ø£Ø·ÙØ§Ù„, Whisper, DAF, Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù†Ø·Ù‚, Stuttering, Speech Therapy, Fluency, Kids, Delayed Auditory Feedback, whisper.com.ly, open source">
    <meta name="author" content="whisper.com.ly Team">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://whisper.com.ly/">
    <meta property="og:title" content="whisper.com.ly â€“ ØªØ­Ø¯Ø« Ø¨Ø·Ù„Ø§Ù‚Ø© ÙˆØ«Ù‚Ø©">
    <meta property="og:description" content="Ø£Ø¯Ø§Ø© Ø°ÙƒÙŠØ© Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ù‚Ø© Ø§Ù„ÙƒÙ„Ø§Ù…ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„Ø³Ù…Ø¹ÙŠ. Smart tool for improving speech fluency.">
    <meta property="og:image" content="https://whisper.com.ly/og-image.jpg">

    <!-- Favicon (SVG Base64) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ—£ï¸</text></svg>">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&family=Nunito:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Tajawal', 'Nunito', 'Arial', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            900: '#0c4a6e',
                        },
                        dark: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            text: '#f1f5f9',
                            border: '#334155'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Global Transitions */
        body {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Splash Screen */
        #splash-screen {
            transition: opacity 0.8s ease-out, visibility 0.8s ease-out;
        }
        #splash-screen.hidden-splash {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* Button Effects */
        .action-btn {
            transition: transform 0.1s, box-shadow 0.1s, background-color 0.3s;
        }
        .action-btn:active {
            transform: scale(0.98);
        }

        /* Visualizer */
        .visualizer-container {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        .bar {
            width: 8px;
            background-color: #0ea5e9;
            border-radius: 999px;
            height: 10px;
            transition: height 0.1s ease;
        }
        .dark .bar { background-color: #38bdf8; }

        /* Child Mode Styles */
        body.child-mode { background-color: #FFFBEB; }
        body.child-mode.dark { background-color: #422006; }
        
        body.child-mode .main-card {
            border-radius: 2rem;
            border: 4px solid #FCD34D;
            box-shadow: 0 10px 25px -5px rgba(245, 158, 11, 0.2);
        }
        body.child-mode .action-btn-primary {
            background-color: #10B981;
            box-shadow: 0 6px 0 #059669;
        }
        body.child-mode .action-btn-primary:hover { background-color: #059669; }
        body.child-mode .action-btn-primary:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #047857;
        }
        body.child-mode .bar { background-color: #EC4899; width: 12px; }

        /* Range Slider */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; }
        input[type=range]:focus { outline: none; }

        /* Animations */
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse-slow { animation: pulseSlow 3s infinite; }
        @keyframes pulseSlow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* Modal */
        .modal {
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        .modal:not(.hidden) {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
    </style>
</head>
<body class="bg-brand-50 dark:bg-dark-bg text-slate-800 dark:text-dark-text min-h-screen flex flex-col font-sans selection:bg-brand-200 dark:selection:bg-brand-900 overflow-x-hidden">

    <!-- Splash Screen -->
    <div id="splash-screen" class="fixed inset-0 z-50 bg-white dark:bg-dark-bg flex flex-col items-center justify-center text-center p-4">
        <div class="relative w-32 h-32 mb-6">
            <!-- Phone Vector -->
            <svg class="w-full h-full text-brand-600 dark:text-brand-400 absolute top-0 left-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
                <path d="M12 18h.01"></path>
            </svg>
            <!-- Headphones Vector -->
            <svg class="w-20 h-20 text-brand-500 dark:text-brand-300 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 -mt-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"></path>
            </svg>
            <!-- Sound Waves -->
            <div class="absolute -right-8 top-1/2 transform -translate-y-1/2 flex gap-1">
                <div class="w-1 h-4 bg-brand-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                <div class="w-1 h-8 bg-brand-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                <div class="w-1 h-4 bg-brand-400 rounded-full animate-bounce" style="animation-delay: 0.3s"></div>
            </div>
        </div>
        <h1 class="text-3xl font-black text-brand-900 dark:text-white mb-2 tracking-tight">whisper.com.ly</h1>
        <p class="text-slate-500 dark:text-slate-400 text-sm max-w-xs mx-auto" data-i18n="splash_text">ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ù‚Ø© Ø§Ù„ÙƒÙ„Ø§Ù…ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ© DAF ÙˆØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©.</p>
    </div>

    <!-- Header Section -->
    <header class="bg-white/80 dark:bg-dark-card/80 backdrop-blur-md shadow-sm sticky top-0 z-40 border-b border-slate-100 dark:border-dark-border transition-colors">
        <div class="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
            <!-- Logo -->
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-brand-600 rounded-xl flex items-center justify-center text-white text-xl shadow-md">
                    <!-- SVG Logo -->
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 3V21M8 7V17M16 7V17M4 11V13M20 11V13" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-xl font-black text-brand-900 dark:text-white leading-none tracking-tight">whisper.com.ly</h1>
                    <span class="text-xs text-slate-500 dark:text-slate-400 font-medium" data-i18n="tagline">Ø±ÙÙŠÙ‚ Ø§Ù„Ø·Ù„Ø§Ù‚Ø©</span>
                </div>
            </div>
            
            <!-- Controls -->
            <div class="flex items-center gap-2">
                <!-- Language Toggle -->
                <button id="langBtn" class="w-9 h-9 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-brand-100 transition flex items-center justify-center font-bold text-xs">
                    EN
                </button>

                <!-- Dark Mode Toggle -->
                <button id="darkModeBtn" class="w-9 h-9 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-yellow-400 hover:bg-brand-100 transition flex items-center justify-center">
                    <i class="fa-solid fa-moon"></i>
                </button>

                <!-- Child Mode Toggle -->
                <button id="childModeBtn" class="flex items-center gap-2 px-3 py-2 rounded-full border-2 border-slate-200 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 transition text-xs font-bold text-slate-600 dark:text-slate-300">
                    <i class="fa-solid fa-child text-base"></i>
                    <span class="hidden sm:inline" data-i18n="child_mode">ÙˆØ¶Ø¹ Ø§Ù„Ø·ÙÙ„</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-6 max-w-3xl">
        
        <!-- Warning -->
        <div id="headphoneWarning" class="bg-blue-50 dark:bg-blue-900/20 border-r-4 border-brand-500 p-4 mb-6 rounded-lg shadow-sm flex items-center gap-4 transition-colors">
            <div class="bg-white dark:bg-slate-800 p-2 rounded-full shadow-sm">
                <i class="fa-solid fa-headset text-brand-600 dark:text-brand-400 text-2xl"></i>
            </div>
            <div>
                <h3 class="font-bold text-brand-900 dark:text-brand-100" data-i18n="warning_title">ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…</h3>
                <p class="text-sm text-brand-700 dark:text-brand-200" data-i18n="warning_text">ÙŠØ±Ø¬Ù‰ Ø§Ø±ØªØ¯Ø§Ø¡ Ø³Ù…Ø§Ø¹Ø§Øª Ø§Ù„Ø±Ø£Ø³ (Headphones) Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØµØ¯Ù‰ ÙˆØ¶Ù…Ø§Ù† Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø©.</p>
            </div>
        </div>

        <!-- Main Control Card -->
        <div class="main-card bg-white dark:bg-dark-card rounded-3xl shadow-xl p-6 mb-8 transition-all duration-300 border border-slate-100 dark:border-dark-border">
            
            <!-- Timer & Status -->
            <div class="flex justify-between items-center mb-8 bg-slate-50 dark:bg-slate-800 p-4 rounded-2xl transition-colors">
                <div class="flex items-center gap-3">
                    <i class="fa-solid fa-stopwatch text-2xl text-slate-400 dark:text-slate-500"></i>
                    <div>
                        <span class="block text-xs text-slate-500 dark:text-slate-400 font-bold" data-i18n="timer_label">ÙˆÙ‚Øª Ø§Ù„ØªÙ…Ø±ÙŠÙ†</span>
                        <div id="timerDisplay" class="text-2xl font-mono font-bold text-slate-800 dark:text-white">00:00</div>
                    </div>
                </div>
                <div class="flex items-center gap-2 bg-white dark:bg-slate-700 px-3 py-1 rounded-full shadow-sm border border-slate-100 dark:border-slate-600">
                    <div id="statusDot" class="w-3 h-3 rounded-full bg-slate-300 transition-colors duration-300"></div>
                    <span id="statusText" class="text-sm font-bold text-slate-500 dark:text-slate-300" data-i18n="status_ready">Ø¬Ø§Ù‡Ø²</span>
                </div>
            </div>

            <!-- Visualizer -->
            <div class="visualizer-container mb-8" id="visualizer">
                <!-- JS Generated Bars -->
            </div>

            <!-- Main Button -->
            <div class="flex justify-center mb-8">
                <button id="startBtn" class="action-btn action-btn-primary bg-brand-600 hover:bg-brand-700 text-white w-56 h-16 rounded-full text-xl font-bold shadow-lg shadow-brand-500/30 flex items-center justify-center gap-3 transition-all duration-300">
                    <i class="fa-solid fa-microphone"></i>
                    <span data-i18n="btn_start">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯Ø«</span>
                </button>
            </div>

            <!-- Audio Settings -->
            <div class="border-t-2 border-slate-50 dark:border-slate-700 pt-6 space-y-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-slate-700 dark:text-slate-200" data-i18n="settings_title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª</h3>
                    <button id="resetBtn" class="text-xs text-slate-400 hover:text-red-500 font-medium flex items-center gap-1 transition-colors">
                        <i class="fa-solid fa-rotate-right"></i> <span data-i18n="btn_reset">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</span>
                    </button>
                </div>

                <!-- Delay -->
                <div class="bg-slate-50 dark:bg-slate-800 p-4 rounded-xl transition-colors">
                    <div class="flex justify-between mb-2">
                        <label class="text-sm font-bold text-slate-700 dark:text-slate-300 flex items-center gap-2">
                            <i class="fa-solid fa-clock text-brand-500"></i> <span data-i18n="label_delay">Ø§Ù„ØªØ£Ø®ÙŠØ± (DAF)</span>
                        </label>
                        <span id="delayVal" class="text-xs bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 px-2 py-1 rounded text-slate-600 dark:text-slate-300 font-mono">0 ms</span>
                    </div>
                    <input type="range" id="delayRange" min="0" max="0.5" step="0.01" value="0" class="w-full h-2 bg-slate-200 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-brand-600 hover:accent-brand-700">
                </div>

                <!-- Pitch -->
                <div class="bg-slate-50 dark:bg-slate-800 p-4 rounded-xl transition-colors">
                    <div class="flex justify-between mb-2">
                        <label class="text-sm font-bold text-slate-700 dark:text-slate-300 flex items-center gap-2">
                            <i class="fa-solid fa-sliders text-brand-500"></i> <span data-i18n="label_pitch">Ù†Ø¨Ø±Ø© Ø§Ù„ØµÙˆØª</span>
                        </label>
                        <span id="pitchVal" class="text-xs bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 px-2 py-1 rounded text-slate-600 dark:text-slate-300" data-i18n="val_normal">Ø·Ø¨ÙŠØ¹ÙŠ</span>
                    </div>
                    <input type="range" id="pitchRange" min="500" max="4000" step="100" value="2000" class="w-full h-2 bg-slate-200 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-brand-600 hover:accent-brand-700">
                </div>
                
                <!-- Volume -->
                <div class="bg-slate-50 dark:bg-slate-800 p-4 rounded-xl transition-colors">
                    <div class="flex justify-between mb-2">
                        <label class="text-sm font-bold text-slate-700 dark:text-slate-300 flex items-center gap-2">
                            <i class="fa-solid fa-volume-high text-brand-500"></i> <span data-i18n="label_vol">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª</span>
                        </label>
                        <span id="volVal" class="text-xs bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 px-2 py-1 rounded text-slate-600 dark:text-slate-300 font-mono">100%</span>
                    </div>
                    <input type="range" id="volRange" min="0" max="2" step="0.1" value="1" class="w-full h-2 bg-slate-200 dark:bg-slate-600 rounded-lg appearance-none cursor-pointer accent-brand-600 hover:accent-brand-700">
                </div>
            </div>
        </div>

        <!-- Practice Section -->
        <section class="mt-8">
            <div class="flex justify-between items-end mb-4">
                <h2 class="text-xl font-black text-slate-800 dark:text-white flex items-center gap-2">
                    <i class="fa-solid fa-book-open text-brand-500"></i>
                    <span data-i18n="practice_title">Ù‡ÙŠØ§ Ù†ØªØ¯Ø±Ø¨</span>
                </h2>
                <span class="text-xs text-slate-500 dark:text-slate-400 font-medium" data-i18n="practice_subtitle">Ø§Ù‚Ø±Ø£ Ø¨ØµÙˆØª Ù‡Ø§Ø¯Ø¦</span>
            </div>
            
            <div class="bg-white dark:bg-dark-card rounded-2xl shadow-lg border-b-4 border-brand-100 dark:border-brand-900 p-8 text-center relative overflow-hidden transition-colors">
                <div class="absolute top-0 left-0 w-full h-2 bg-brand-500 opacity-20"></div>
                
                <div id="practiceCard" class="mb-8 min-h-[80px] flex items-center justify-center">
                    <p id="practiceText" class="text-2xl md:text-3xl font-bold text-slate-700 dark:text-slate-200 leading-relaxed fade-in">
                        "Ø§Ù„Ø´Ù…Ø³ Ù…Ø´Ø±Ù‚Ø© Ø§Ù„ÙŠÙˆÙ… ğŸŒ"
                    </p>
                </div>

                <div class="flex justify-center gap-4">
                    <button onclick="prevSentence()" class="w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 text-slate-600 dark:text-slate-300 transition flex items-center justify-center">
                        <i class="fa-solid fa-chevron-right rtl:rotate-180"></i>
                    </button>
                    
                    <button onclick="nextSentence()" class="px-8 py-3 bg-brand-100 dark:bg-brand-900 hover:bg-brand-200 dark:hover:bg-brand-800 text-brand-700 dark:text-brand-300 rounded-full font-bold transition flex items-center gap-2">
                        <span data-i18n="btn_next">Ø§Ù„ØªØ§Ù„ÙŠ</span>
                        <i class="fa-solid fa-arrow-left rtl:rotate-180"></i>
                    </button>
                </div>
            </div>
            
            <p class="text-center text-slate-400 text-sm mt-4 font-medium" data-i18n="motivational_quote">"ÙƒÙ„ ÙƒÙ„Ù…Ø© ØªÙ‚ÙˆÙ„Ù‡Ø§ ØªØ¹Ù†ÙŠ Ø´ÙŠØ¦Ù‹Ø§ ğŸŒŸ"</p>
        </section>

        <!-- Information Grid -->
        <section class="mt-12 grid grid-cols-2 md:grid-cols-4 gap-4">
            <button onclick="openModal('modal-story')" class="p-4 bg-white dark:bg-dark-card rounded-xl shadow-sm hover:shadow-md transition text-center border border-slate-100 dark:border-dark-border group">
                <div class="w-10 h-10 mx-auto bg-pink-100 dark:bg-pink-900 rounded-full flex items-center justify-center text-pink-500 mb-2 group-hover:scale-110 transition">
                    <i class="fa-solid fa-heart"></i>
                </div>
                <span class="text-xs font-bold text-slate-600 dark:text-slate-300" data-i18n="menu_story">Ù‚ØµØªÙŠ</span>
            </button>
            
            <button onclick="openModal('modal-map')" class="p-4 bg-white dark:bg-dark-card rounded-xl shadow-sm hover:shadow-md transition text-center border border-slate-100 dark:border-dark-border group">
                <div class="w-10 h-10 mx-auto bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center text-purple-500 mb-2 group-hover:scale-110 transition">
                    <i class="fa-solid fa-sitemap"></i>
                </div>
                <span class="text-xs font-bold text-slate-600 dark:text-slate-300" data-i18n="menu_map">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ</span>
            </button>

            <button onclick="openModal('modal-about')" class="p-4 bg-white dark:bg-dark-card rounded-xl shadow-sm hover:shadow-md transition text-center border border-slate-100 dark:border-dark-border group">
                <div class="w-10 h-10 mx-auto bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center text-blue-500 mb-2 group-hover:scale-110 transition">
                    <i class="fa-solid fa-info"></i>
                </div>
                <span class="text-xs font-bold text-slate-600 dark:text-slate-300" data-i18n="menu_about">Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
            </button>

            <button onclick="openModal('modal-legal')" class="p-4 bg-white dark:bg-dark-card rounded-xl shadow-sm hover:shadow-md transition text-center border border-slate-100 dark:border-dark-border group">
                <div class="w-10 h-10 mx-auto bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center text-gray-500 mb-2 group-hover:scale-110 transition">
                    <i class="fa-solid fa-scale-balanced"></i>
                </div>
                <span class="text-xs font-bold text-slate-600 dark:text-slate-300" data-i18n="menu_legal">Ù‚Ø§Ù†ÙˆÙ†ÙŠ</span>
            </button>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white dark:bg-dark-card border-t border-slate-100 dark:border-dark-border mt-auto py-8 transition-colors">
        <div class="container mx-auto px-4 text-center">
            
            <!-- Backup Domain Section -->
            <div class="mb-8 p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl max-w-md mx-auto border border-slate-100 dark:border-slate-700">
                <h4 class="text-sm font-bold text-slate-700 dark:text-slate-200 mb-2" data-i18n="backup_title">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</h4>
                <p class="text-xs text-slate-500 dark:text-slate-400 mb-4" data-i18n="backup_desc">ÙÙŠ Ø­Ø§Ù„ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù…ØªØ§Ø­Ù‹Ø§ØŒ ÙŠÙ…ÙƒÙ†ÙƒÙ… Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§.</p>
                <div class="flex flex-col items-center gap-3">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=https://alhams-1.blogspot.com" alt="QR Code" class="w-24 h-24 rounded-lg border-2 border-white dark:border-slate-600 shadow-sm">
                    <a href="https://alhams-1.blogspot.com" target="_blank" class="text-xs font-mono text-brand-600 dark:text-brand-400 hover:underline break-all">https://alhams-1.blogspot.com</a>
                </div>
            </div>

            <div class="flex justify-center gap-4 mb-4">
                <a href="#" class="w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-slate-500 dark:text-slate-400 hover:bg-brand-500 hover:text-white transition"><i class="fa-brands fa-twitter"></i></a>
                <a href="#" class="w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-slate-500 dark:text-slate-400 hover:bg-brand-500 hover:text-white transition"><i class="fa-brands fa-instagram"></i></a>
                <a href="https://github.com/Gamingmonster2/whisper.com.ly" target="_blank" class="w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-slate-500 dark:text-slate-400 hover:bg-brand-500 hover:text-white transition"><i class="fa-brands fa-github"></i></a>
            </div>
            <p class="text-slate-500 dark:text-slate-400 text-sm mb-2 font-medium">
                <span data-i18n="footer_credit">ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ø­Ø¨ Ø¨ÙˆØ§Ø³Ø·Ø© ÙØ±ÙŠÙ‚ whisper.com.ly</span> &copy; <span id="year">2026</span>
            </p>
            <div class="flex justify-center gap-4 text-xs text-slate-400 dark:text-slate-500">
                <button onclick="openModal('modal-legal')" class="hover:text-brand-600 hover:underline" data-i18n="link_privacy">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</button>
                <span>â€¢</span>
                <button onclick="openModal('modal-legal')" class="hover:text-brand-600 hover:underline" data-i18n="link_terms">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</button>
            </div>
        </div>
    </footer>

    <!-- Modals Container -->
    <div id="modal-overlay" class="modal hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4" onclick="closeAllModals(event)">
        
        <!-- Story Modal -->
        <div id="modal-story" class="modal-content hidden bg-white dark:bg-dark-card w-full max-w-2xl rounded-3xl shadow-2xl p-6 md:p-8 max-h-[90vh] overflow-y-auto relative">
            <button onclick="closeAllModals()" class="absolute top-4 left-4 text-slate-400 hover:text-red-500"><i class="fa-solid fa-xmark text-2xl"></i></button>
            <div class="flex items-center gap-3 mb-4">
                <div class="p-3 bg-pink-100 dark:bg-pink-900 rounded-full text-pink-500"><i class="fa-solid fa-heart text-xl"></i></div>
                <h2 class="text-2xl font-bold text-slate-800 dark:text-white" data-i18n="story_title">Ø§Ù„Ø¯Ø§ÙØ¹ Ø§Ù„Ø´Ø®ØµÙŠ</h2>
                <button onclick="speakText('story_content')" class="text-brand-500 hover:text-brand-600"><i class="fa-solid fa-volume-high"></i></button>
            </div>
            <div id="story_content" class="prose dark:prose-invert text-slate-600 dark:text-slate-300 leading-relaxed">
                <p class="mb-4" data-i18n="story_p1">Ø¨Ø¯Ø£Øª Ø±Ø­Ù„Ø© whisper.com.ly Ø¹Ù†Ø¯Ù…Ø§ Ù„Ø§Ø­Ø¸Øª Ù…Ø¹Ø§Ù†Ø§Ø© Ø§Ø¨Ù†ØªÙŠ Ø§Ù„ØµØºÙŠØ±Ø© Ù…Ø¹ Ø§Ù„ØªÙ„Ø¹Ø«Ù…. ÙƒØ§Ù† Ø§Ù„Ø£Ù…Ø± Ù…Ø¤Ù„Ù…Ù‹Ø§ Ø£Ù† Ø£Ø±Ù‰ ÙƒÙ„Ù…Ø§ØªÙ‡Ø§ ØªØªØ¹Ø«Ø± Ø±ØºÙ… Ø°ÙƒØ§Ø¦Ù‡Ø§ ÙˆØ­ÙŠÙˆÙŠØªÙ‡Ø§. Ø¨Ø­Ø«Øª ÙƒØ«ÙŠØ±Ù‹Ø§ Ø¹Ù† Ø­Ù„ÙˆÙ„ ØªÙ‚Ù†ÙŠØ© Ø¨Ø³ÙŠØ·Ø© ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„ Ø¯ÙˆÙ† ØªØ¹Ù‚ÙŠØ¯.</p>
                <p class="mb-4" data-i18n="story_p2">Ø§ÙƒØªØ´ÙØª ØªÙ‚Ù†ÙŠØ© "Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„Ø³Ù…Ø¹ÙŠ" (DAF) ÙˆØªØ£Ø«ÙŠØ± "Ø§Ù„Ù‡Ù…Ø³" (Whisper) ÙÙŠ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ù‚Ø©. Ù‚Ø±Ø±Øª Ø¨Ù†Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„ÙŠØ³ ÙÙ‚Ø· Ù„Ø§Ø¨Ù†ØªÙŠØŒ Ø¨Ù„ Ù„ÙƒÙ„ Ø·ÙÙ„ ÙˆØ´Ø®Øµ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¯ÙØ¹Ø© Ù…Ù† Ø§Ù„Ø«Ù‚Ø©.</p>
                <p class="font-bold text-brand-600" data-i18n="story_p3">Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…ÙØªÙˆØ­ Ø§Ù„Ù…ØµØ¯Ø± ÙˆÙ…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø¬Ù…ÙŠØ¹ØŒ Ù„Ø£Ù† Ø§Ù„Ø·Ù„Ø§Ù‚Ø© Ø­Ù‚ Ù„ÙƒÙ„ Ø¥Ù†Ø³Ø§Ù†.</p>
            </div>
        </div>

        <!-- Mind Map Modal -->
        <div id="modal-map" class="modal-content hidden bg-white dark:bg-dark-card w-full max-w-3xl rounded-3xl shadow-2xl p-6 md:p-8 max-h-[90vh] overflow-y-auto relative">
            <button onclick="closeAllModals()" class="absolute top-4 left-4 text-slate-400 hover:text-red-500"><i class="fa-solid fa-xmark text-2xl"></i></button>
            <h2 class="text-2xl font-bold text-slate-800 dark:text-white mb-6 text-center" data-i18n="map_title">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ whisper.com.lyØŸ</h2>
            
            <!-- Interactive Map Visualization -->
            <div class="flex flex-col md:flex-row items-center justify-center gap-4 text-center">
                <!-- Step 1 -->
                <div class="flex flex-col items-center group">
                    <div class="w-20 h-20 bg-slate-100 dark:bg-slate-700 rounded-full flex items-center justify-center text-3xl text-slate-600 dark:text-slate-300 mb-2 group-hover:bg-brand-500 group-hover:text-white transition shadow-sm">
                        <i class="fa-solid fa-microphone-lines"></i>
                    </div>
                    <span class="font-bold text-sm dark:text-white" data-i18n="map_step1">ØµÙˆØªÙƒ</span>
                </div>
                <!-- Arrow -->
                <div class="h-1 w-8 md:w-16 bg-slate-200 dark:bg-slate-600 rounded-full relative">
                    <div class="absolute right-0 -top-1 w-2 h-2 border-t-2 border-r-2 border-slate-200 dark:border-slate-600 rotate-45"></div>
                </div>
                
                <!-- Step 2 -->
                <div class="flex flex-col items-center group">
                    <div class="w-20 h-20 bg-slate-100 dark:bg-slate-700 rounded-full flex items-center justify-center text-3xl text-slate-600 dark:text-slate-300 mb-2 group-hover:bg-brand-500 group-hover:text-white transition shadow-sm">
                        <i class="fa-solid fa-wave-square"></i>
                    </div>
                    <span class="font-bold text-sm dark:text-white" data-i18n="map_step2">Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© (DAF)</span>
                    <span class="text-xs text-slate-400">ØªØ£Ø®ÙŠØ± + ØªØºÙŠÙŠØ± Ù†Ø¨Ø±Ø©</span>
                </div>
                <!-- Arrow -->
                <div class="h-1 w-8 md:w-16 bg-slate-200 dark:bg-slate-600 rounded-full relative">
                    <div class="absolute right-0 -top-1 w-2 h-2 border-t-2 border-r-2 border-slate-200 dark:border-slate-600 rotate-45"></div>
                </div>

                <!-- Step 3 -->
                <div class="flex flex-col items-center group">
                    <div class="w-20 h-20 bg-slate-100 dark:bg-slate-700 rounded-full flex items-center justify-center text-3xl text-slate-600 dark:text-slate-300 mb-2 group-hover:bg-brand-500 group-hover:text-white transition shadow-sm">
                        <i class="fa-solid fa-ear-listen"></i>
                    </div>
                    <span class="font-bold text-sm dark:text-white" data-i18n="map_step3">Ø£Ø°Ù†Ùƒ</span>
                </div>
                <!-- Arrow -->
                <div class="h-1 w-8 md:w-16 bg-slate-200 dark:bg-slate-600 rounded-full relative">
                    <div class="absolute right-0 -top-1 w-2 h-2 border-t-2 border-r-2 border-slate-200 dark:border-slate-600 rotate-45"></div>
                </div>

                <!-- Step 4 -->
                <div class="flex flex-col items-center group">
                    <div class="w-20 h-20 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center text-3xl text-green-600 mb-2 group-hover:scale-110 transition shadow-sm">
                        <i class="fa-regular fa-face-smile-beam"></i>
                    </div>
                    <span class="font-bold text-sm dark:text-white" data-i18n="map_step4">Ø·Ù„Ø§Ù‚Ø© ÙˆØ«Ù‚Ø©</span>
                </div>
            </div>
            
            <div class="mt-8 bg-slate-50 dark:bg-slate-800 p-4 rounded-xl text-sm text-slate-600 dark:text-slate-300">
                <strong data-i18n="map_note_title">Ù…Ù„Ø§Ø­Ø¸Ø© Ø°ÙƒÙŠØ©:</strong> <span data-i18n="map_note_text">ÙŠØ®Ø¯Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ù…Ø§Øº (ØªØ£Ø«ÙŠØ± Ø§Ù„ÙƒÙˆØ±Ø§Ù„) Ù…Ù…Ø§ ÙŠÙ‚Ù„Ù„ Ø§Ù„ØªÙ„Ø¹Ø«Ù… ÙÙˆØ±ÙŠØ§Ù‹.</span>
            </div>
        </div>

        <!-- About & Legal Modal -->
        <div id="modal-legal" class="modal-content hidden bg-white dark:bg-dark-card w-full max-w-2xl rounded-3xl shadow-2xl p-6 md:p-8 max-h-[90vh] overflow-y-auto relative">
            <button onclick="closeAllModals()" class="absolute top-4 left-4 text-slate-400 hover:text-red-500"><i class="fa-solid fa-xmark text-2xl"></i></button>
            
            <div class="space-y-8">
                <!-- About -->
                <section>
                    <h3 class="text-xl font-bold text-brand-600 mb-2" data-i18n="about_title">Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h3>
                    <p class="text-sm text-slate-600 dark:text-slate-300 mb-2" data-i18n="about_text">whisper.com.ly Ù‡Ùˆ ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ ØªÙ‚Ø¯Ù…ÙŠ (PWA) ÙŠÙ‡Ø¯Ù Ù„ØªÙˆÙÙŠØ± Ø£Ø¯ÙˆØ§Øª Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ø¬Ø§Ù†Ù‹Ø§. ÙŠØ³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„ÙˆÙŠØ¨ Ø§Ù„Ø­Ø¯ÙŠØ«Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø®ØµÙˆØµÙŠØ©ØŒ Ø­ÙŠØ« ØªØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØª Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ ÙˆÙ„Ø§ ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡ Ù„Ø£ÙŠ Ø®Ø§Ø¯Ù….</p>
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-100 dark:border-blue-800">
                        <p class="text-xs font-bold text-blue-800 dark:text-blue-200" data-i18n="about_reason">ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø§Ø³Ù… Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Hums Ù…ÙØªÙˆØ­ Ø§Ù„Ù…ØµØ¯Ø± Ø¨Ø¹Ø¯ ØªØ¬Ø±Ø¨Ø© ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚ OpenAI.</p>
                    </div>
                </section>

                <!-- Children Warning -->
                <section>
                    <h3 class="text-xl font-bold text-brand-600 mb-2" data-i18n="kids_warning_title">ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ø£Ø·ÙØ§Ù„</h3>
                    <p class="text-sm text-slate-600 dark:text-slate-300" data-i18n="kids_warning_text">ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ØªØ­Øª Ø¥Ø´Ø±Ø§Ù Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª Ø¢Ù…Ù† Ù„Ù„Ø£Ø°Ù†.</p>
                </section>

                <!-- Privacy -->
                <section>
                    <h3 class="text-xl font-bold text-brand-600 mb-2" data-i18n="privacy_title">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h3>
                    <ul class="list-disc list-inside text-sm text-slate-600 dark:text-slate-300 space-y-1">
                        <li data-i18n="privacy_1">Ù„Ø§ Ù†Ù‚ÙˆÙ… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø£Ùˆ ØªØ®Ø²ÙŠÙ† ØµÙˆØªÙƒ.</li>
                        <li data-i18n="privacy_2">Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØªÙ… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­ (Client-side).</li>
                        <li data-i18n="privacy_3">Ù†Ø³ØªØ®Ø¯Ù… Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Cookies) ÙÙ‚Ø· Ù„Ø­ÙØ¸ ØªÙØ¶ÙŠÙ„Ø§ØªÙƒ (Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠØŒ Ø§Ù„Ù„ØºØ©).</li>
                    </ul>
                </section>

                <!-- Terms -->
                <section>
                    <h3 class="text-xl font-bold text-brand-600 mb-2" data-i18n="terms_title">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
                    <p class="text-sm text-slate-600 dark:text-slate-300" data-i18n="terms_text">Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø£Ø¯Ø§Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆÙ„ÙŠØ³ Ø¨Ø¯ÙŠÙ„Ø§Ù‹ Ø¹Ù† Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø·Ø¨ÙŠ Ø£Ùˆ Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù…Ù‡Ù†ÙŠ. Ø§Ù„Ù…Ø·ÙˆØ± ØºÙŠØ± Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø£ÙŠ Ø³ÙˆØ¡ Ø§Ø³ØªØ®Ø¯Ø§Ù….</p>
                </section>
            </div>
        </div>

        <!-- Generic About Modal -->
        <div id="modal-about" class="modal-content hidden bg-white dark:bg-dark-card w-full max-w-md rounded-3xl shadow-2xl p-6 relative text-center">
             <button onclick="closeAllModals()" class="absolute top-4 left-4 text-slate-400 hover:text-red-500"><i class="fa-solid fa-xmark text-2xl"></i></button>
             <div class="w-20 h-20 bg-brand-100 dark:bg-brand-900 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">ğŸ—£ï¸</div>
             <h2 class="text-2xl font-black text-brand-900 dark:text-white mb-2">whisper.com.ly</h2>
             <p class="text-slate-500 dark:text-slate-400 mb-6" data-i18n="about_version">Ù†Ø³Ø®Ø© Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ù…ØµØ¯Ø± 2026</p>
             
             <div class="bg-slate-50 dark:bg-slate-800 p-4 rounded-xl text-left text-xs font-mono text-slate-600 dark:text-slate-300 mb-4 overflow-x-auto break-all">
                 <a href="https://github.com/Gamingmonster2/whisper.com.ly" target="_blank" class="hover:text-brand-500">https://github.com/Gamingmonster2/whisper.com.ly</a>
             </div>
             <p class="text-xs text-slate-400" data-i18n="about_opensource">Ø³Ø§Ù‡Ù… ÙÙŠ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¹Ø¨Ø± GitHub</p>
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        /**
         * whisper.com.ly App Logic v2.0
         * Includes: Audio Processing, Localization, Dark Mode, TTS, Modals, Splash Screen.
         */

        // --- Splash Screen Logic ---
        window.addEventListener('load', () => {
            setTimeout(() => {
                const splash = document.getElementById('splash-screen');
                splash.classList.add('hidden-splash');
            }, 4000); // 4 Seconds
        });

        // --- Localization Data ---
        const translations = {
            ar: {
                tagline: "Ø±ÙÙŠÙ‚ Ø§Ù„Ø·Ù„Ø§Ù‚Ø©",
                splash_text: "ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ù‚Ø© Ø§Ù„ÙƒÙ„Ø§Ù…ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ© DAF ÙˆØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©.",
                child_mode: "ÙˆØ¶Ø¹ Ø§Ù„Ø·ÙÙ„",
                warning_title: "ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…",
                warning_text: "ÙŠØ±Ø¬Ù‰ Ø§Ø±ØªØ¯Ø§Ø¡ Ø³Ù…Ø§Ø¹Ø§Øª Ø§Ù„Ø±Ø£Ø³ (Headphones) Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØµØ¯Ù‰ ÙˆØ¶Ù…Ø§Ù† Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø©.",
                timer_label: "ÙˆÙ‚Øª Ø§Ù„ØªÙ…Ø±ÙŠÙ†",
                status_ready: "Ø¬Ø§Ù‡Ø²",
                status_listening: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹",
                btn_start: "Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯Ø«",
                btn_stop: "Ø¥ÙŠÙ‚Ø§Ù",
                settings_title: "Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØª",
                btn_reset: "Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·",
                label_delay: "Ø§Ù„ØªØ£Ø®ÙŠØ± (DAF)",
                label_pitch: "Ù†Ø¨Ø±Ø© Ø§Ù„ØµÙˆØª",
                label_vol: "Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª",
                val_normal: "Ø·Ø¨ÙŠØ¹ÙŠ",
                val_deep: "Ø¹Ù…ÙŠÙ‚",
                val_sharp: "Ø­Ø§Ø¯",
                practice_title: "Ù‡ÙŠØ§ Ù†ØªØ¯Ø±Ø¨",
                practice_subtitle: "Ø§Ù‚Ø±Ø£ Ø¨ØµÙˆØª Ù‡Ø§Ø¯Ø¦",
                btn_next: "Ø§Ù„ØªØ§Ù„ÙŠ",
                motivational_quote: "\"ÙƒÙ„ ÙƒÙ„Ù…Ø© ØªÙ‚ÙˆÙ„Ù‡Ø§ ØªØ¹Ù†ÙŠ Ø´ÙŠØ¦Ù‹Ø§ ğŸŒŸ\"",
                menu_story: "Ù‚ØµØªÙŠ",
                menu_map: "ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ",
                menu_about: "Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚",
                menu_legal: "Ù‚Ø§Ù†ÙˆÙ†ÙŠ",
                footer_credit: "ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ø­Ø¨ Ø¨ÙˆØ§Ø³Ø·Ø© ÙØ±ÙŠÙ‚ whisper.com.ly",
                link_privacy: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©",
                link_terms: "Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…",
                story_title: "Ø§Ù„Ø¯Ø§ÙØ¹ Ø§Ù„Ø´Ø®ØµÙŠ",
                story_p1: "Ø¨Ø¯Ø£Øª Ø±Ø­Ù„Ø© whisper.com.ly Ø¹Ù†Ø¯Ù…Ø§ Ù„Ø§Ø­Ø¸Øª Ù…Ø¹Ø§Ù†Ø§Ø© Ø§Ø¨Ù†ØªÙŠ Ø§Ù„ØµØºÙŠØ±Ø© Ù…Ø¹ Ø§Ù„ØªÙ„Ø¹Ø«Ù…. ÙƒØ§Ù† Ø§Ù„Ø£Ù…Ø± Ù…Ø¤Ù„Ù…Ù‹Ø§ Ø£Ù† Ø£Ø±Ù‰ ÙƒÙ„Ù…Ø§ØªÙ‡Ø§ ØªØªØ¹Ø«Ø± Ø±ØºÙ… Ø°ÙƒØ§Ø¦Ù‡Ø§ ÙˆØ­ÙŠÙˆÙŠØªÙ‡Ø§.",
                story_p2: "Ø§ÙƒØªØ´ÙØª ØªÙ‚Ù†ÙŠØ© \"Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„Ø³Ù…Ø¹ÙŠ\" (DAF) ÙˆØªØ£Ø«ÙŠØ± \"Ø§Ù„Ù‡Ù…Ø³\" ÙÙŠ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ù‚Ø©. Ù‚Ø±Ø±Øª Ø¨Ù†Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„ÙŠØ³ ÙÙ‚Ø· Ù„Ø§Ø¨Ù†ØªÙŠØŒ Ø¨Ù„ Ù„ÙƒÙ„ Ø·ÙÙ„.",
                story_p3: "Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…ÙØªÙˆØ­ Ø§Ù„Ù…ØµØ¯Ø± ÙˆÙ…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø¬Ù…ÙŠØ¹.",
                map_title: "ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ whisper.com.lyØŸ",
                map_step1: "ØµÙˆØªÙƒ",
                map_step2: "Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©",
                map_step3: "Ø£Ø°Ù†Ùƒ",
                map_step4: "Ø·Ù„Ø§Ù‚Ø© ÙˆØ«Ù‚Ø©",
                map_note_title: "Ù…Ù„Ø§Ø­Ø¸Ø© Ø°ÙƒÙŠØ©:",
                map_note_text: "ÙŠØ®Ø¯Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ù…Ø§Øº (ØªØ£Ø«ÙŠØ± Ø§Ù„ÙƒÙˆØ±Ø§Ù„) Ù…Ù…Ø§ ÙŠÙ‚Ù„Ù„ Ø§Ù„ØªÙ„Ø¹Ø«Ù… ÙÙˆØ±ÙŠØ§Ù‹.",
                about_title: "Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚",
                about_text: "whisper.com.ly Ù‡Ùˆ ØªØ·Ø¨ÙŠÙ‚ ÙˆÙŠØ¨ ØªÙ‚Ø¯Ù…ÙŠ (PWA) ÙŠÙ‡Ø¯Ù Ù„ØªÙˆÙÙŠØ± Ø£Ø¯ÙˆØ§Øª Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ø¬Ø§Ù†Ù‹Ø§. ØªØªÙ… Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø­Ù„ÙŠØ§Ù‹.",
                about_reason: "ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø§Ø³Ù… Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Hums Ù…ÙØªÙˆØ­ Ø§Ù„Ù…ØµØ¯Ø± Ø¨Ø¹Ø¯ ØªØ¬Ø±Ø¨Ø© ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚ OpenAI.",
                kids_warning_title: "ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ø£Ø·ÙØ§Ù„",
                kids_warning_text: "ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ØªØ­Øª Ø¥Ø´Ø±Ø§Ù Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª Ø¢Ù…Ù† Ù„Ù„Ø£Ø°Ù†.",
                privacy_title: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©",
                privacy_1: "Ù„Ø§ Ù†Ù‚ÙˆÙ… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø£Ùˆ ØªØ®Ø²ÙŠÙ† ØµÙˆØªÙƒ.",
                privacy_2: "Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØªÙ… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­.",
                privacy_3: "Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙˆÙƒÙŠØ² Ù„Ø­ÙØ¸ Ø§Ù„ØªÙØ¶ÙŠÙ„Ø§Øª ÙÙ‚Ø·.",
                terms_title: "Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…",
                terms_text: "Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø£Ø¯Ø§Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆÙ„ÙŠØ³ Ø¨Ø¯ÙŠÙ„Ø§Ù‹ Ø¹Ù† Ø§Ù„ØªØ´Ø®ÙŠØµ Ø§Ù„Ø·Ø¨ÙŠ.",
                about_version: "Ù†Ø³Ø®Ø© Ù…ÙØªÙˆØ­Ø© Ø§Ù„Ù…ØµØ¯Ø± 2026",
                about_opensource: "Ø³Ø§Ù‡Ù… ÙÙŠ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¹Ø¨Ø± GitHub",
                backup_title: "Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ",
                backup_desc: "ÙÙŠ Ø­Ø§Ù„ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù…ØªØ§Ø­Ù‹Ø§ØŒ ÙŠÙ…ÙƒÙ†ÙƒÙ… Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§."
            },
            en: {
                tagline: "Fluency Companion",
                splash_text: "Web app to improve speech fluency using DAF technology and reading exercises.",
                child_mode: "Child Mode",
                warning_title: "Important",
                warning_text: "Please wear headphones to avoid echo and ensure the best experience.",
                timer_label: "Session Time",
                status_ready: "Ready",
                status_listening: "Listening",
                btn_start: "Start Speaking",
                btn_stop: "Stop",
                settings_title: "Audio Settings",
                btn_reset: "Reset",
                label_delay: "Delay (DAF)",
                label_pitch: "Pitch/Tone",
                label_vol: "Volume",
                val_normal: "Normal",
                val_deep: "Deep",
                val_sharp: "Sharp",
                practice_title: "Let's Practice",
                practice_subtitle: "Read calmly",
                btn_next: "Next",
                motivational_quote: "\"Every word you say matters ğŸŒŸ\"",
                menu_story: "My Story",
                menu_map: "How it works",
                menu_about: "About",
                menu_legal: "Legal",
                footer_credit: "Developed with love by whisper.com.ly Team",
                link_privacy: "Privacy Policy",
                link_terms: "Terms of Use",
                story_title: "Personal Motivation",
                story_p1: "whisper.com.ly journey began when I noticed my little daughter struggling with stuttering. It was painful to see her words stumble despite her intelligence.",
                story_p2: "I discovered DAF technology and the 'Whisper' effect. I decided to build this tool not just for her, but for every child.",
                story_p3: "This project is open source and free for everyone.",
                map_title: "How whisper.com.ly Works?",
                map_step1: "Voice",
                map_step2: "Processing",
                map_step3: "Ear",
                map_step4: "Fluency",
                map_note_title: "Smart Note:",
                map_note_text: "This system tricks the brain (Choral Effect) reducing stuttering instantly.",
                about_title: "About App",
                about_text: "whisper.com.ly is a PWA providing advanced speech therapy tools for free. Audio is processed locally on your device.",
                about_reason: "The name was chosen to create a free, open-source version of the Hums app after experimenting with OpenAI app development.",
                kids_warning_title: "Children Warning",
                kids_warning_text: "This app should be used under parental supervision. Ensure volume is safe for ears.",
                privacy_title: "Privacy Policy",
                privacy_1: "We do not record or store your voice.",
                privacy_2: "Processing is done entirely client-side.",
                privacy_3: "Cookies are used only for preferences.",
                terms_title: "Terms of Use",
                terms_text: "This tool is an aid, not a substitute for professional medical diagnosis.",
                about_version: "Open Source Version 2026",
                about_opensource: "Contribute via GitHub",
                backup_title: "Backup Link",
                backup_desc: "In case the main domain is unavailable, you can save the backup link for later access."
            }
        };

        const sentencesAr = [
            "Ø§Ù„Ø´Ù…Ø³ Ù…Ø´Ø±Ù‚Ø© Ø§Ù„ÙŠÙˆÙ… ğŸŒ",
            "Ø°Ù‡Ø¨Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆØªØ¹Ù„Ù…Øª Ø£Ø´ÙŠØ§Ø¡ Ø¬Ø¯ÙŠØ¯Ø© ğŸ“š",
            "Ø£Ù†Ø§ Ø£ØªÙƒÙ„Ù… Ø¨Ù‡Ø¯ÙˆØ¡ ÙˆØ¨Ø«Ù‚Ø© ğŸ˜„",
            "Ø£Ø­Ø¨ Ø£Ù† Ø£Ø³ØªÙ…Ø¹ Ù„Ù„Ø¢Ø®Ø±ÙŠÙ† ÙˆØ£ØªØ­Ø¯Ø« Ø¨ÙˆØ¶ÙˆØ­ ğŸ—£ï¸",
            "Ø§Ù„Ø³Ù…Ø§Ø¡ Ø²Ø±Ù‚Ø§Ø¡ ÙˆØ§Ù„Ø·ÙŠÙˆØ± ØªØºØ±Ø¯ ğŸ¦",
            "Ø£ØªÙ†ÙØ³ Ø¨Ø¹Ù…Ù‚ Ù‚Ø¨Ù„ Ø£Ù† Ø£Ø¨Ø¯Ø£ Ø§Ù„ÙƒÙ„Ø§Ù… ğŸƒ"
        ];
        const sentencesEn = [
            "The sun is shining today ğŸŒ",
            "I went to school and learned new things ğŸ“š",
            "I speak calmly and with confidence ğŸ˜„",
            "I love listening to others and speaking clearly ğŸ—£ï¸",
            "The sky is blue and birds are singing ğŸ¦",
            "I take a deep breath before I start speaking ğŸƒ"
        ];

        // --- System Variables ---
        let audioContext = null;
        let mediaStream = null;
        let sourceNode, delayNode, gainNode, filterNode, analyser;
        let isRunning = false;
        let timerInterval = null;
        let seconds = 0;
        let isChildMode = false;
        let currentLang = 'ar';
        let currentSentenceIndex = 0;

        // --- UI Elements ---
        const startBtn = document.getElementById('startBtn');
        const statusText = document.getElementById('statusText');
        const statusDot = document.getElementById('statusDot');
        const timerDisplay = document.getElementById('timerDisplay');
        const visualizerContainer = document.getElementById('visualizer');
        const childModeBtn = document.getElementById('childModeBtn');
        const practiceText = document.getElementById('practiceText');
        const resetBtn = document.getElementById('resetBtn');
        const langBtn = document.getElementById('langBtn');
        const darkModeBtn = document.getElementById('darkModeBtn');
        
        // Sliders
        const delayRange = document.getElementById('delayRange');
        const delayVal = document.getElementById('delayVal');
        const volRange = document.getElementById('volRange');
        const volVal = document.getElementById('volVal');
        const pitchRange = document.getElementById('pitchRange');
        const pitchVal = document.getElementById('pitchVal');

        // --- Initialization ---
        document.getElementById('year').textContent = "2026";
        
        // Check LocalStorage for prefs
        if(localStorage.getItem('theme') === 'dark') {
            document.documentElement.classList.add('dark');
            darkModeBtn.innerHTML = '<i class="fa-solid fa-sun"></i>';
        }
        if(localStorage.getItem('lang') === 'en') {
            setLanguage('en');
        }

        // --- Audio Logic ---
        async function initAudio() {
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                audioContext = new AudioContext();
                mediaStream = await navigator.mediaDevices.getUserMedia({ 
                    audio: { echoCancellation: false, noiseSuppression: false, autoGainControl: false } 
                });

                sourceNode = audioContext.createMediaStreamSource(mediaStream);
                delayNode = audioContext.createDelay(1.0);
                delayNode.delayTime.value = parseFloat(delayRange.value); 
                gainNode = audioContext.createGain();
                gainNode.gain.value = parseFloat(volRange.value);
                filterNode = audioContext.createBiquadFilter();
                filterNode.type = "lowpass"; 
                filterNode.frequency.value = parseFloat(pitchRange.value);
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 32;

                sourceNode.connect(delayNode);
                delayNode.connect(filterNode);
                filterNode.connect(gainNode);
                gainNode.connect(audioContext.destination);
                gainNode.connect(analyser);

                startVisualizer();
                return true;
            } catch (err) {
                console.error("Mic Error:", err);
                alert(currentLang === 'ar' ? "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†." : "Please allow microphone access.");
                return false;
            }
        }

        startBtn.addEventListener('click', async () => {
            if (!isRunning) {
                if (!audioContext) {
                    const success = await initAudio();
                    if (!success) return;
                } else if (audioContext.state === 'suspended') {
                    await audioContext.resume();
                }
                isRunning = true;
                updateUIState(true);
                startTimer();
            } else {
                if (audioContext) await audioContext.suspend();
                isRunning = false;
                updateUIState(false);
                stopTimer();
            }
        });

        function updateUIState(active) {
            const t = translations[currentLang];
            if (active) {
                startBtn.classList.replace('bg-brand-600', 'bg-red-500');
                startBtn.classList.replace('hover:bg-brand-700', 'hover:bg-red-600');
                startBtn.innerHTML = `<i class="fa-solid fa-stop"></i> <span>${t.btn_stop}</span>`;
                statusText.innerText = t.status_listening;
                statusText.classList.replace('text-slate-500', 'text-brand-600');
                statusText.classList.replace('dark:text-slate-300', 'dark:text-brand-400');
                statusDot.classList.replace('bg-slate-300', 'bg-red-500');
                statusDot.classList.add('animate-pulse');
            } else {
                startBtn.classList.replace('bg-red-500', 'bg-brand-600');
                startBtn.classList.replace('hover:bg-red-600', 'hover:bg-brand-700');
                startBtn.innerHTML = `<i class="fa-solid fa-microphone"></i> <span>${t.btn_start}</span>`;
                statusText.innerText = t.status_ready;
                statusText.classList.replace('text-brand-600', 'text-slate-500');
                statusText.classList.replace('dark:text-brand-400', 'dark:text-slate-300');
                statusDot.classList.replace('bg-red-500', 'bg-slate-300');
                statusDot.classList.remove('animate-pulse');
            }
        }

        function updateAudioSettings() {
            if (!audioContext) return;
            if(delayNode) delayNode.delayTime.setTargetAtTime(parseFloat(delayRange.value), audioContext.currentTime, 0.1);
            if(gainNode) gainNode.gain.setTargetAtTime(parseFloat(volRange.value), audioContext.currentTime, 0.1);
            if(filterNode) filterNode.frequency.setTargetAtTime(parseFloat(pitchRange.value), audioContext.currentTime, 0.1);
        }

        // Sliders Events
        delayRange.addEventListener('input', (e) => {
            delayVal.innerText = `${Math.round(e.target.value * 1000)} ms`;
            updateAudioSettings();
        });
        volRange.addEventListener('input', (e) => {
            volVal.innerText = `${Math.round(e.target.value * 100)}%`;
            updateAudioSettings();
        });
        pitchRange.addEventListener('input', (e) => {
            const val = parseFloat(e.target.value);
            const t = translations[currentLang];
            if(val < 1000) pitchVal.innerText = t.val_deep;
            else if(val > 3000) pitchVal.innerText = t.val_sharp;
            else pitchVal.innerText = t.val_normal;
            updateAudioSettings();
        });

        resetBtn.addEventListener('click', () => {
            delayRange.value = 0;
            volRange.value = 1;
            pitchRange.value = 2000;
            const t = translations[currentLang];
            delayVal.innerText = "0 ms";
            volVal.innerText = "100%";
            pitchVal.innerText = t.val_normal;
            updateAudioSettings();
        });

        // --- Practice Logic ---
        function showSentence(index) {
            practiceText.classList.remove('fade-in');
            void practiceText.offsetWidth; 
            practiceText.classList.add('fade-in');
            const list = currentLang === 'ar' ? sentencesAr : sentencesEn;
            practiceText.innerText = `"${list[index]}"`;
        }

        function nextSentence() {
            const list = currentLang === 'ar' ? sentencesAr : sentencesEn;
            currentSentenceIndex = (currentSentenceIndex + 1) % list.length;
            showSentence(currentSentenceIndex);
        }

        function prevSentence() {
            const list = currentLang === 'ar' ? sentencesAr : sentencesEn;
            currentSentenceIndex = (currentSentenceIndex - 1 + list.length) % list.length;
            showSentence(currentSentenceIndex);
        }

        // --- Timer ---
        function startTimer() {
            timerInterval = setInterval(() => {
                seconds++;
                const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
                const secs = (seconds % 60).toString().padStart(2, '0');
                timerDisplay.innerText = `${mins}:${secs}`;
            }, 1000);
        }
        function stopTimer() { clearInterval(timerInterval); }

        // --- Visualizer ---
        function startVisualizer() {
            const dataArray = new Uint8Array(analyser.frequencyBinCount);
            const bars = visualizerContainer.querySelectorAll('.bar');
            function draw() {
                if (!isRunning) {
                    bars.forEach(bar => bar.style.height = '6px');
                    return;
                }
                requestAnimationFrame(draw);
                analyser.getByteFrequencyData(dataArray);
                bars.forEach((bar, i) => {
                    const value = dataArray[i * 2] || 0;
                    const height = Math.max(6, (value / 255) * 50);
                    bar.style.height = `${height}px`;
                });
            }
            draw();
        }

        // --- Toggles (Child, Dark, Lang) ---
        childModeBtn.addEventListener('click', () => {
            isChildMode = !isChildMode;
            document.body.classList.toggle('child-mode');
            const t = translations[currentLang];
            if (isChildMode) {
                childModeBtn.classList.add('bg-yellow-100', 'border-yellow-400', 'text-yellow-700');
                childModeBtn.classList.remove('dark:border-slate-600');
                childModeBtn.innerHTML = `<i class="fa-solid fa-check"></i> <span>${currentLang === 'ar' ? 'Ù…ÙØ¹Ù„' : 'On'}</span>`;
                document.querySelectorAll('input[type=range]').forEach(input => {
                    input.classList.remove('accent-brand-600');
                    input.classList.add('accent-pink-500');
                });
            } else {
                childModeBtn.classList.remove('bg-yellow-100', 'border-yellow-400', 'text-yellow-700');
                childModeBtn.classList.add('dark:border-slate-600');
                childModeBtn.innerHTML = `<i class="fa-solid fa-child text-base"></i> <span class="hidden sm:inline">${t.child_mode}</span>`;
                document.querySelectorAll('input[type=range]').forEach(input => {
                    input.classList.remove('accent-pink-500');
                    input.classList.add('accent-brand-600');
                });
            }
        });

        darkModeBtn.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            darkModeBtn.innerHTML = isDark ? '<i class="fa-solid fa-sun"></i>' : '<i class="fa-solid fa-moon"></i>';
        });

        langBtn.addEventListener('click', () => {
            setLanguage(currentLang === 'ar' ? 'en' : 'ar');
        });

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('lang', lang);
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.documentElement.lang = lang;
            langBtn.innerText = lang === 'ar' ? 'EN' : 'AR';
            
            // Update Text
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if(translations[lang][key]) el.innerText = translations[lang][key];
            });

            // Update Dynamic Content
            showSentence(currentSentenceIndex);
            updateUIState(isRunning);
            
            // Update Pitch Label
            const pitchValNum = parseFloat(pitchRange.value);
            if(pitchValNum < 1000) pitchVal.innerText = translations[lang].val_deep;
            else if(pitchValNum > 3000) pitchVal.innerText = translations[lang].val_sharp;
            else pitchVal.innerText = translations[lang].val_normal;
        }

        // --- Modals ---
        function openModal(id) {
            document.getElementById('modal-overlay').classList.remove('hidden');
            document.querySelectorAll('.modal-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function closeAllModals(e) {
            if (e && e.target !== document.getElementById('modal-overlay') && !e.target.closest('button')) return;
            document.getElementById('modal-overlay').classList.add('hidden');
        }

        // --- TTS (AI Voice) ---
        function speakText(elementId) {
            const text = document.getElementById(elementId).innerText;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = currentLang === 'ar' ? 'ar-SA' : 'en-US';
            window.speechSynthesis.speak(utterance);
        }

        // --- Initial Setup ---
        visualizerContainer.innerHTML = '';
        for(let i=0; i<12; i++) {
            const div = document.createElement('div');
            div.className = 'bar';
            visualizerContainer.appendChild(div);
        }
        showSentence(0);

    </script>
</body>
</html>
